import streamlit as st
import pandas as pd

# ---------------------- æ•°æ®å®šä¹‰ ----------------------
# å—å®ç¾é£Ÿé¤å…åŸºç¡€æ•°æ®ï¼ˆâ‰¥5å®¶ï¼‰
restaurants = pd.DataFrame({
    "é¤å…": ["æ˜Ÿè‰ºä¼šå°ä¸å¿˜", "é«˜å³°æŸ æª¬é¸­", "å¤è®°è€å‹ç²‰", "å¥½å‹ç¼˜", "è¥¿å†·ç‰›æ’åº—", "ä¸­å±±è·¯è€ç‰Œç²‰åº—"],
    "ç±»å‹": ["ä¸­é¤", "ä¸­é¤", "å¿«é¤", "è‡ªåŠ©é¤", "è¥¿é¤", "å¿«é¤"],
    "è¯„åˆ†": [4.2, 4.5, 4.0, 4.7, 4.3, 4.1],
    "äººå‡æ¶ˆè´¹(å…ƒ)": [15, 20, 25, 35, 50, 18],
    "latitude": [22.853838, 22.965046, 22.812200, 22.809105, 22.839699, 22.845210],  # å—å®åæ ‡
    "longitude": [108.222177, 108.353921, 108.266629, 108.378664, 108.245804, 108.230102]
})
restaurants.index.name = "åºå·"

# 12ä¸ªæœˆé¤å…ä»·æ ¼èµ°åŠ¿ï¼ˆ5å®¶é¤å…ï¼‰
months = [f"{i:02d}æœˆ" for i in range(1, 13)]
price_trend = pd.DataFrame({
    "æœˆä»½": months,
    "æ˜Ÿè‰ºä¼šå°ä¸å¿˜": [15, 16, 15, 17, 16, 15, 16, 17, 15, 16, 17, 15],
    "é«˜å³°æŸ æª¬é¸­": [20, 21, 20, 22, 21, 20, 21, 22, 20, 21, 22, 20],
    "å¤è®°è€å‹ç²‰": [25, 26, 25, 27, 26, 25, 26, 27, 25, 26, 27, 25],
    "å¥½å‹ç¼˜": [35, 36, 35, 37, 36, 35, 36, 37, 35, 36, 37, 35],
    "è¥¿å†·ç‰›æ’åº—": [50, 51, 50, 52, 51, 50, 51, 52, 50, 51, 52, 50]
})

# ç”¨é¤é«˜å³°æ—¶æ®µæ•°æ®ï¼ˆæ¨¡æ‹Ÿï¼‰
peak_hours = pd.DataFrame({
    "æ—¶æ®µ": ["10:00", "11:00", "12:00", "13:00", "17:00", "18:00", "19:00", "20:00"],
    "å®¢æµé‡": [50, 120, 180, 80, 100, 200, 150, 90]
})

# ---------------------- ç•Œé¢å¸ƒå±€ ----------------------
st.title("å—å®ç¾é£Ÿæ•°æ®ä»ªè¡¨ç›˜")

# 1. ç¾é£Ÿåº—é“ºåˆ†å¸ƒåœ°å›¾
st.subheader("å—å®ç¾é£Ÿåº—é“ºåˆ†å¸ƒ")
st.map(restaurants[["latitude", "longitude"]])

# 2. é¤å…è¯„åˆ†æ¡å½¢å›¾
st.subheader("é¤å…è¯„åˆ†")
st.bar_chart(restaurants, x="é¤å…", y="è¯„åˆ†")

# 3. ä¸åŒç±»å‹é¤å…äººå‡ä»·æ ¼
st.subheader("ä¸åŒç±»å‹é¤å…äººå‡ä»·æ ¼")
type_avg_price = restaurants.groupby("ç±»å‹")["äººå‡æ¶ˆè´¹(å…ƒ)"].mean().reset_index()
st.line_chart(type_avg_price, x="ç±»å‹", y="äººå‡æ¶ˆè´¹(å…ƒ)")

# 4. 12ä¸ªæœˆé¤å…ä»·æ ¼èµ°åŠ¿ï¼ˆ5æ¡æŠ˜çº¿ï¼‰
st.subheader("12ä¸ªæœˆé¤å…ä»·æ ¼èµ°åŠ¿")
st.line_chart(price_trend, x="æœˆä»½", y=["æ˜Ÿè‰ºä¼šå°ä¸å¿˜", "é«˜å³°æŸ æª¬é¸­", "å¤è®°è€å‹ç²‰", "å¥½å‹ç¼˜", "è¥¿å†·ç‰›æ’åº—"])

# 5. ç”¨é¤é«˜å³°æ—¶æ®µé¢ç§¯å›¾
st.subheader("ç”¨é¤é«˜å³°æ—¶æ®µ")
st.area_chart(peak_hours, x="æ—¶æ®µ", y="å®¢æµé‡")

# 6. é¤å…è¯¦æƒ…
st.subheader("é¤å…è¯¦æƒ…")
st.dataframe(restaurants[["é¤å…", "ç±»å‹", "è¯„åˆ†", "äººå‡æ¶ˆè´¹(å…ƒ)"]])

# 7. ä»Šæ—¥åˆé¤æ¨èï¼ˆç‚¹å‡»æ›´æ–°ï¼‰
st.subheader("ä»Šæ—¥åˆé¤æ¨è")
if st.button("å¸®æˆ‘é€‰åˆé¤"):
    selected = restaurants.sample(n=1)  # éšæœºé€‰ä¸€å®¶
    st.write(f"ğŸœ ä»Šæ—¥æ¨èï¼š{selected['é¤å…'].values[0]}")
    st.write(f"ç±»å‹ï¼š{selected['ç±»å‹'].values[0]} | äººå‡ï¼š{selected['äººå‡æ¶ˆè´¹(å…ƒ)'].values[0]}å…ƒ | è¯„åˆ†ï¼š{selected['è¯„åˆ†'].values[0]}")
    # å±•ç¤ºå—å®ç¾é£Ÿå›¾ç‰‡ï¼ˆç½‘ç»œç¤ºä¾‹å›¾ï¼‰
    st.image("https://img.ixintu.com/download/jpg/202305/849513d1a299083d419885d224885318.jpg!custom.jpg", 
             caption="å—å®ç‰¹è‰²ç¾é£Ÿ")
else:
    st.write("ç‚¹å‡»ã€Œå¸®æˆ‘é€‰åˆé¤ã€è·å–ä»Šæ—¥æ¨è~")
